# è®¾è®¡æ–‡æ¡£

## æ¦‚è¿°

æœ¬è®¾è®¡å°† Gemini Chat ä»çº¯ Web åº”ç”¨æ‰©å±•ä¸ºæ”¯æŒ Electron æ¡Œé¢åº”ç”¨ï¼Œå®ç° Windows exe å®‰è£…åŒ…çš„è‡ªåŠ¨åŒ–æ„å»ºå’Œå‘å¸ƒã€‚é‡‡ç”¨ Vite + Electron çš„é›†æˆæ–¹æ¡ˆï¼Œä½¿ç”¨ electron-builder è¿›è¡Œæ‰“åŒ…ï¼Œé€šè¿‡ GitHub Actions å®ç° CI/CD è‡ªåŠ¨åŒ–ã€‚

## æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    GitHub Repository                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ¨é€ v* æ ‡ç­¾                                                â”‚
â”‚       â†“                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚              GitHub Actions Workflow                 â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚  â”‚  â”‚ æ£€å‡ºä»£ç     â”‚â†’â”‚ æ„å»º Vite   â”‚â†’â”‚ æ„å»º Electronâ”‚  â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚  â”‚         â†“                                            â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚  â”‚  â”‚ ç”Ÿæˆ Release Notes (Conventional Commits)   â”‚    â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
â”‚  â”‚         â†“                                            â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚  â”‚  â”‚ ä¸Šä¼  Assets åˆ° GitHub Releases              â”‚    â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ç»„ä»¶å’Œæ¥å£

### 1. Electron ä¸»è¿›ç¨‹ (electron/main.js)

```javascript
// ä¸»è¿›ç¨‹å…¥å£æ–‡ä»¶
const { app, BrowserWindow } = require('electron')
const path = require('path')

function createWindow() {
  const mainWindow = new BrowserWindow({
    width: 1200,
    height: 800,
    webPreferences: {
      nodeIntegration: false,
      contextIsolation: true
    }
  })

  // å¼€å‘æ¨¡å¼åŠ è½½ Vite å¼€å‘æœåŠ¡å™¨
  // ç”Ÿäº§æ¨¡å¼åŠ è½½æ‰“åŒ…åçš„æ–‡ä»¶
  if (process.env.NODE_ENV === 'development') {
    mainWindow.loadURL('http://localhost:5173')
  } else {
    mainWindow.loadFile(path.join(__dirname, '../dist/index.html'))
  }
}

app.whenReady().then(createWindow)
```

### 2. electron-builder é…ç½® (electron-builder.yml)

```yaml
appId: com.gemini.chat
productName: Gemini Chat
directories:
  output: release
  buildResources: build

files:
  - dist/**/*
  - electron/**/*

win:
  target:
    - target: nsis
      arch: [x64]
  icon: build/icon.ico

nsis:
  oneClick: false
  allowToChangeInstallationDirectory: true
  createDesktopShortcut: true
  createStartMenuShortcut: true
```

### 3. GitHub Actions å·¥ä½œæµ

```yaml
name: Release

on:
  push:
    tags:
      - 'v*'

jobs:
  release:
    runs-on: windows-latest
    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0
      
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'
          cache: 'npm'
      
      - name: Install dependencies
        run: npm ci
      
      - name: Build
        run: npm run build
      
      - name: Build Electron
        run: npm run electron:build
      
      - name: Generate Release Notes
        id: changelog
        uses: conventional-changelog/conventional-changelog-action@v5
      
      - name: Create Release
        uses: softprops/action-gh-release@v1
        with:
          body: ${{ steps.changelog.outputs.changelog }}
          files: release/*.exe
```

## æ•°æ®æ¨¡å‹

### package.json æ–°å¢è„šæœ¬

```json
{
  "scripts": {
    "electron:dev": "concurrently \"npm run dev\" \"wait-on http://localhost:5173 && electron .\"",
    "electron:build": "npm run build && electron-builder"
  },
  "main": "electron/main.js",
  "build": {
    "extends": "electron-builder.yml"
  }
}
```

### Conventional Commits ç±»å‹æ˜ å°„

| Commit ç±»å‹ | Release Notes åˆ†ç±» | ç¤ºä¾‹ |
|------------|-------------------|------|
| feat | âœ¨ Features | feat: æ·»åŠ å¯¼å‡ºåŠŸèƒ½ |
| fix | ğŸ› Bug Fixes | fix: ä¿®å¤æ¶ˆæ¯æ˜¾ç¤ºé—®é¢˜ |
| refactor | â™»ï¸ Code Refactoring | refactor: é‡æ„æ¶ˆæ¯ç»„ä»¶ |
| style | ğŸ’„ Styles | style: ä¼˜åŒ– UI æ ·å¼ |
| perf | âš¡ Performance | perf: ä¼˜åŒ–æ¸²æŸ“æ€§èƒ½ |
| docs | ğŸ“ Documentation | docs: æ›´æ–° README |

## ç›®å½•ç»“æ„

```
gemini-chat/
â”œâ”€â”€ electron/
â”‚   â””â”€â”€ main.js              # Electron ä¸»è¿›ç¨‹
â”œâ”€â”€ build/
â”‚   â””â”€â”€ icon.ico             # åº”ç”¨å›¾æ ‡
â”œâ”€â”€ .github/
â”‚   â””â”€â”€ workflows/
â”‚       â”œâ”€â”€ docker-build.yml # ç°æœ‰ Docker æ„å»º
â”‚       â””â”€â”€ release.yml      # æ–°å¢ Release æ„å»º
â”œâ”€â”€ electron-builder.yml     # electron-builder é…ç½®
â”œâ”€â”€ commitlint.config.js     # commitlint é…ç½®
â””â”€â”€ package.json             # æ›´æ–°åçš„é…ç½®
```


## æ­£ç¡®æ€§å±æ€§

*æ­£ç¡®æ€§å±æ€§æ˜¯æŒ‡åœ¨ç³»ç»Ÿæ‰€æœ‰æœ‰æ•ˆæ‰§è¡Œä¸­éƒ½åº”è¯¥ä¿æŒä¸ºçœŸçš„ç‰¹å¾æˆ–è¡Œä¸ºâ€”â€”æœ¬è´¨ä¸Šæ˜¯å…³äºç³»ç»Ÿåº”è¯¥åšä»€ä¹ˆçš„å½¢å¼åŒ–é™ˆè¿°ã€‚å±æ€§ä½œä¸ºäººç±»å¯è¯»è§„èŒƒå’Œæœºå™¨å¯éªŒè¯æ­£ç¡®æ€§ä¿è¯ä¹‹é—´çš„æ¡¥æ¢ã€‚*

ç”±äºæœ¬åŠŸèƒ½ä¸»è¦æ¶‰åŠé…ç½®æ–‡ä»¶å’Œ CI/CD æµç¨‹ï¼Œå¤§éƒ¨åˆ†éœ€æ±‚æ˜¯é…ç½®æ€§çš„ï¼Œä¸é€‚åˆå±æ€§æµ‹è¯•ã€‚ä»¥ä¸‹æ˜¯å¯æµ‹è¯•çš„å±æ€§ï¼š

### Property 1: Commitlint æ‹’ç»æ— æ•ˆæäº¤ä¿¡æ¯

*å¯¹äºä»»æ„* ä¸ç¬¦åˆ Conventional Commits è§„èŒƒçš„æäº¤ä¿¡æ¯ï¼Œcommitlint åº”è¯¥è¿”å›éªŒè¯é”™è¯¯ã€‚

**éªŒè¯: éœ€æ±‚ 3.3**

### Property 2: Release Notes åŒ…å«æ‰€æœ‰æäº¤

*å¯¹äºä»»æ„* ç¬¦åˆ Conventional Commits è§„èŒƒçš„æäº¤åˆ—è¡¨ï¼Œç”Ÿæˆçš„ Release Notes åº”è¯¥åŒ…å«æ‰€æœ‰æäº¤çš„æè¿°ä¿¡æ¯ï¼Œå¹¶æŒ‰ç±»å‹æ­£ç¡®åˆ†ç»„ã€‚

**éªŒè¯: éœ€æ±‚ 4.4, 4.5**

## é”™è¯¯å¤„ç†

### Electron åº”ç”¨é”™è¯¯

| é”™è¯¯åœºæ™¯ | å¤„ç†æ–¹å¼ |
|---------|---------|
| åŠ è½½é¡µé¢å¤±è´¥ | æ˜¾ç¤ºé”™è¯¯é¡µé¢ï¼Œæä¾›é‡è¯•é€‰é¡¹ |
| ä¸»è¿›ç¨‹å´©æºƒ | è®°å½•é”™è¯¯æ—¥å¿—ï¼Œä¼˜é›…é€€å‡º |

### æ„å»ºé”™è¯¯

| é”™è¯¯åœºæ™¯ | å¤„ç†æ–¹å¼ |
|---------|---------|
| ä¾èµ–å®‰è£…å¤±è´¥ | GitHub Actions æŠ¥å‘Šå¤±è´¥ï¼Œä¸åˆ›å»º Release |
| æ„å»ºå¤±è´¥ | GitHub Actions æŠ¥å‘Šå¤±è´¥ï¼Œä¸ä¸Šä¼  Assets |
| ç­¾åå¤±è´¥ | è·³è¿‡ç­¾åï¼Œç»§ç»­æ„å»ºï¼ˆå¯é€‰ï¼‰ |

## æµ‹è¯•ç­–ç•¥

### å•å…ƒæµ‹è¯•

ç”±äºæœ¬åŠŸèƒ½ä¸»è¦æ˜¯é…ç½®å’Œé›†æˆï¼Œå•å…ƒæµ‹è¯•èŒƒå›´æœ‰é™ï¼š
- éªŒè¯é…ç½®æ–‡ä»¶æ ¼å¼æ­£ç¡®
- éªŒè¯è„šæœ¬å‘½ä»¤å­˜åœ¨

### é›†æˆæµ‹è¯•

- æœ¬åœ°è¿è¡Œ `npm run electron:dev` éªŒè¯å¼€å‘æ¨¡å¼
- æœ¬åœ°è¿è¡Œ `npm run electron:build` éªŒè¯æ„å»ºæµç¨‹
- æ¨é€æµ‹è¯•æ ‡ç­¾éªŒè¯ GitHub Actions æµç¨‹

### å±æ€§æµ‹è¯•

ä½¿ç”¨ fast-check è¿›è¡Œå±æ€§æµ‹è¯•ï¼š
- æµ‹è¯• commitlint å¯¹å„ç§è¾“å…¥çš„éªŒè¯è¡Œä¸º
- æµ‹è¯• Release Notes ç”Ÿæˆçš„æ­£ç¡®æ€§

æµ‹è¯•é…ç½®ï¼š
- æ¯ä¸ªå±æ€§æµ‹è¯•è¿è¡Œè‡³å°‘ 100 æ¬¡è¿­ä»£
- ä½¿ç”¨ fast-check ç”Ÿæˆéšæœºæµ‹è¯•æ•°æ®
